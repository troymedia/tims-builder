<?xml version="1.0" encoding="utf-8"?>
<s:BorderContainer xmlns:fx="http://ns.adobe.com/mxml/2009" 
				   xmlns:s="library://ns.adobe.com/flex/spark" 
				   xmlns:mx="library://ns.adobe.com/flex/mx"
				   backgroundColor="0x333333"
				   xmlns:components="com.ecistm.tlpa.components.*"
				   xmlns:views="com.ecistm.tlpa.views.*"
				   cornerRadius="10" >
	<fx:Declarations>
		
	</fx:Declarations>
	
	<fx:Script>
		<![CDATA[
			import com.ecistm.tlpa.models.LessonModel;
			
			import flash.media.*;
			import flash.net.URLRequest;
			
			import mx.collections.ArrayCollection;
			import mx.controls.Alert;
			import mx.controls.RadioButton;
			import mx.rpc.events.FaultEvent;
			import mx.rpc.events.ResultEvent;
			
			import spark.components.Button;
			import spark.components.NavigatorContent;
			import spark.components.RadioButton;
			[Bindable] protected var numOfIncorrectAnswers:int = 0;
			[Bindable] public var lessons:ArrayCollection;
			
			[Bindable] protected var questions:ArrayCollection;
			public var rb:spark.components.RadioButton;
			
			public function buildQuiz(data:*):void
			{
				for each(var qp:Object in data.questionPool)
				{
					var navContent:NavigatorContent = new NavigatorContent();
					navContent.percentHeight = navContent.percentWidth = 100;
					var questionPool:QuestionPool = new QuestionPool();
					for each(var q:Object in qp.question)
					{
						var question:Question = new Question();
						question.type = q.type;
						question.questionText = q.text;
//						question.audio = q.audio;
						question.cardinality = q.cardinality;
						for each(var r:Object in q.response)
						{
							question.rb = new spark.components.RadioButton();
							question.rb.groupName = 'questionPool';
							question.rb.label = r.text;
							question.rb.setStyle('color', 'white');
							question.rb.setStyle('fontSize', 12);
							question.rb.name = (r.correct == 0) ? 'false' : 'true';
							question.addElement(question.rb);
						}
						questionPool.questions.addItem(question);
						navContent.addElement(questionPool);
						stack.addElement(navContent);
					}
//					Alert.show('num of questions: ' + String(questionPool.numElements));
				}
//				Alert.show('number of question pools: ' + String(stack.numElements) + '\n' + 'number of questions: ' + String(questionPool.questions.length));
			}
			
			public function stepToNextQuestionPool():void
			{
				stack.selectedIndex += 1;
			}
			
			public function stepToNextQuestion():void
			{
				if(numOfIncorrectAnswers < 2)
				{
					numOfIncorrectAnswers++
					var currentQuestionPool:QuestionPool = NavigatorContent(stack.selectedChild).getElementAt(0) as QuestionPool;
					currentQuestionPool.questionStack.selectedIndex += 1;
				}	
				else
				{	
					stepToNextQuestion();
				}
			}
		
			public function resetQuiz():void
			{
				//restart quiz logic
			}
			
		]]>
	</fx:Script>
	
	<s:layout>
		<s:VerticalLayout paddingTop="5" paddingLeft="5" paddingRight="5" paddingBottom="5"/>
	</s:layout>
	
	<components:TLPAQuizTitle/>
	
	<s:BorderContainer height="100%" width="100%" backgroundImage="@Embed('assets/images/taxi_dark2.jpg')" borderVisible="true"
					   cornerRadius="10">
		<s:layout>
			<s:VerticalLayout paddingTop="5" paddingLeft="5" paddingRight="5" paddingBottom="5"/>
		</s:layout>
		
		<mx:ViewStack id="stack" width="100%" height="100%">
			
		</mx:ViewStack>
		
	</s:BorderContainer>
	
	<s:HGroup width="100%" horizontalAlign="right">
		<components:SubmitButton/>
	</s:HGroup>
	
</s:BorderContainer>
